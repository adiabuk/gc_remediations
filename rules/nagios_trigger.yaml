--
pack: gc_risk_factor
ref: gc_risk_factor.nagios_trigger
name: nagios_trigger
uid: rule:gc_risk_factor:nagios_trigger
tags: []
type:
  ref: standard
  parameters: {}
enabled: true
trigger:
  type: nagios.service_state_change
  ref: nagios.service_state_change
  description: Trigger type for nagios service state change event.
  parameters: {}
metadata_file: ''
context:
  user: st2admin
criteria:
  trigger.state:
    pattern: "^CRITICAL|OK|WARNING$"
    type: regex
  trigger.state_type:
    pattern: HARD
    type: eq
  trigger.service:
    pattern: "cross_margin_risk"
    type: eq
action:
  ref: gc_risk_factor.network_recovery
  description: try to auto remediate network down device
  parameters:
    down_device: "{{ trigger.host }}"
    down_service: "{{ trigger.service }}"
